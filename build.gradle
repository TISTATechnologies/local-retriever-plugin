/*
 * This file was generated by the Gradle 'init' task.
 */

plugins {
    id 'java'
    id 'maven-publish'
    id "org.jenkins-ci.jpi" version "0.44.0-rc.5"
}

group = 'io.jenkins.plugins'
version = '1.0-SNAPSHOT'
description = 'TODO Plugin'

jenkinsPlugin {
    coreVersion = "2.346.2"                                               // Version of Jenkins core this plugin depends on.
    displayName = "Pipeline: Global Local Libs"                // Human-readable name of plugin.
    url = "http://wiki.jenkins-ci.org/display/JENKINS/SomePluginPage"   // URL for plugin on Jenkins wiki or elsewhere.
    gitHubUrl = "https://github.com/jenkinsci/some-plugin"              // Plugin URL on GitHub. Optional.
    pluginFirstClassLoader = true
    shortName = "local-lib-retriever"                                   // Plugin ID, defaults to the project name without trailing '-plugin'

    // The developers section is optional, and corresponds to the POM developers section.
    developers {
        developer {
            id "scooke11"
            name "Stephen Cooke"
            email "scooke.novo@gmail.com"
        }
    }
}

repositories {
    mavenLocal()
    maven {
        url = uri('https://repo.jenkins-ci.org/public/')
    }
    maven {
        url = uri('https://repo.jenkins-ci.org/releases/')
    }
    maven {
        url = uri('https://repo.maven.apache.org/maven2/')
    }
}

dependencies {

    // Using BOM to get recommended libs for this version of Jenkins 
    implementation enforcedPlatform('org.jenkins-ci.main:jenkins-bom:2.346.2') 

    testImplementation 'org.jenkins-ci.main:jenkins-war:2.346.2'
    testImplementation 'org.jenkins-ci.main:jenkins-test-harness:1784.v83a_b_3ce99392'
    testImplementation 'org.jenkins-ci:test-annotations:1.4'
    testImplementation 'org.jenkins-ci.main:jenkins-war:2.332.4'
    testImplementation 'org.jenkins-ci.main:jenkins-test-harness:1784.v83a_b_3ce99392'
    testImplementation 'org.jenkins-ci:test-annotations:1.4'
    testImplementation 'junit:junit:4.13.2'
    testImplementation 'junit:junit:4.13.2'
    compileOnly 'org.jenkins-ci.main:jenkins-core:2.346.2'
    compileOnly 'javax.servlet:javax.servlet-api:3.1.0'
    compileOnly 'net.jcip:jcip-annotations:1.0'
    compileOnly 'org.codehaus.mojo:animal-sniffer-annotations:1.21'
    compileOnly 'commons-logging:commons-logging:1.2'
    compileOnly 'javax.servlet:javax.servlet-api:3.1.0'
    compileOnly 'net.jcip:jcip-annotations:1.0'
    compileOnly 'org.codehaus.mojo:animal-sniffer-annotations:1.21'
    compileOnly 'commons-logging:commons-logging:1.2'

    // Jenkins plugins deps
    implementation 'org.jenkins-ci:symbol-annotation'
    api 'io.jenkins.plugins:pipeline-groovy-lib:598.vcd66b_a_336510'
}


configurations.all {
    exclude(group: 'javax.servlet', module: 'servlet-api')
    exclude(group: 'org.sonatype.sisu', module: 'sisu-guice')
    exclude(group: 'log4j', module: 'log4j')
    exclude(group: 'log4j', module: 'log4j')
    exclude(group: 'commons-logging', module: 'commons-logging')
    exclude(group: 'commons-logging', module: 'commons-logging')
    exclude(group: 'org.apache.logging.log4j')
    exclude(group: 'org.testng', module: 'testng')
}

tasks.register('testsJar', Jar) {
    archiveClassifier = 'tests'
    from(sourceSets.test.output)
}

publishing {
    publications {
        maven(MavenPublication) {
            from(components.java)
            artifact(testsJar)
        }
    }
}

tasks.withType(JavaCompile) {
    options.encoding = 'UTF-8'
}
